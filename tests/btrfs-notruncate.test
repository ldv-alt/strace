#!/bin/sh
#
# Check the -s inf option of strace on btrfs ioctl.
#
# Copyright (c) 2016-2024 The strace developers.
# All rights reserved.
#
# SPDX-License-Identifier: GPL-2.0-or-later

. "${srcdir=.}/init.sh"

check_prog grep
run_prog ../btrfs > /dev/null
run_strace -a16 -sinf -eioctl $args > "$EXP"
grep -v '^ioctl([012],' < "$LOG" > "$OUT"
match_diff "$OUT" "$EXP"
